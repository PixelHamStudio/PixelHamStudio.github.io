<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>React + Three.js OBJ Model Viewer</title>
    <style>
      body, html {
        margin: 0;
        padding: 0;
        overflow: hidden;
        height: 100%;
      }
      #root {
        width: 100vw;
        height: 100vh;
      }
    </style>

    <!-- React + ReactDOM CDN -->
    <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>

    <!-- Three.js + OBJLoader CDN -->
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/three@0.160.0/examples/js/loaders/OBJLoader.js"></script>
  </head>

  <body>
    <div id="root"></div>

    <script type="text/javascript">
      const { useRef, useEffect } = React;

      const OBJ_MODEL_URL = "https://pixelhamstudio.github.io/three2/kirby.obj"; // Replace with your OBJ file URL
      const TEXTURE_URL = "https://pixelhamstudio.github.io/three2/kirby.png"; // Replace with your texture image URL

      function ModelViewer() {
        const mountRef = useRef(null);

        useEffect(() => {
          const width = mountRef.current.clientWidth;
          const height = mountRef.current.clientHeight;

          // Scene, Camera, Renderer
          const scene = new THREE.Scene();
          const camera = new THREE.PerspectiveCamera(75, width / height, 0.1, 1000);
          camera.position.z = 5;

          const renderer = new THREE.WebGLRenderer({ antialias: true });
          renderer.setSize(width, height);
          mountRef.current.appendChild(renderer.domElement);

          // Lighting
          const light = new THREE.DirectionalLight(0xffffff, 1);
          light.position.set(1, 1, 1).normalize();
          scene.add(light);

          // Load Texture and OBJ
          const loader = new THREE.OBJLoader();
          const textureLoader = new THREE.TextureLoader();

          let model;

          textureLoader.load(TEXTURE_URL, (texture) => {
            loader.load(OBJ_MODEL_URL, (obj) => {
              obj.traverse((child) => {
                if (child instanceof THREE.Mesh) {
                  child.material.map = texture;
                  child.material.needsUpdate = true;
                }
              });

              model = obj;
              scene.add(model);
            });
          });

          // Animation
          const animate = function () {
            requestAnimationFrame(animate);
            if (model) {
              model.rotation.y += 0.01;
            }
            renderer.render(scene, camera);
          };
          animate();

          // Cleanup
          return () => {
            mountRef.current.removeChild(renderer.domElement);
          };
        }, []);

        return React.createElement("div", { ref: mountRef, style: { width: "100%", height: "100%" } });
      }

      ReactDOM.createRoot(document.getElementById("root")).render(React.createElement(ModelViewer));
    </script>
  </body>
</html>
